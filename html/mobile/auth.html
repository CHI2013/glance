<!DOCTYPE html>
<html>
  <head> 
    <title>Authenticate</title>
	<meta charset = "UTF-8">
	<meta name = "viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/jquery.mobile.structure-1.1.1.css" />
	<link rel="stylesheet" href="css/jquery.mobile-1.1.1.min.css" />
	<link rel="stylesheet" href="css/custom.css"/>
	<script src="lib/jquery.min.js"></script>
	<script src="lib/jquery.mobile-1.1.1.min.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	<script src="lib/phone.js"></script>
  </head>

  <body>
		<div data-role="page" id="auth" data-theme="a">
			<div data-role="header" style="height:10%">
				<h1> CHI'13 </h1>
			</div>
			<div data-role="content">
				<div id="branding">
					<h1> Current Events</h1>
				</div>
				<div>
					<form method="PUT" action="api/auth" data-ajax="false">
					    <label for="login_username">Username:</label><br>
					    <input type="text" name="login_username" id="login_username" /><br>
					    <label for="login_password">Password:</label><br>
					    <input type="password" name="login_password" id="login_password" /><br>
					    <button id="login_submit" type="submit" data-theme="a">Submit</button>
					</form>
				</div>
			</div>
		</div> <!-- END PAGE -->

		<script>
		
		//Code to sync up with the server
		var socket = io.connect("http://"+window.location.hostname, {port: 8000});

		$(document).ready(function() {
	   		$("#login_submit").click(function(event) {
	        event.preventDefault();
	        var credentials = { type: 'EMAIL', username: $('#login_username').val(), password: $('#login_password').val() };
	        $.ajax({
	            type: "PUT",
	            url: "api/auth",
	            cache: false,
	            data: JSON.stringify(credentials),
	            contentType: "application/json; charset=utf-8",
	            success: function(data) {
	                //validate the response here, set variables... whatever needed
	                    //and if credentials are valid, forward to the next page
	                $.mobile.changePage($('#home'));
	                    //or show an error message
	            },
	            error: function() { // server couldn't be reached or other error 
	        }
	        });
	    });
		});

		</script>
	</body>
</html>